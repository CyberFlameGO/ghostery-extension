/**
 * Detail Menu Component
 *
 * Ghostery Browser Extension
 * https://www.ghostery.com/
 *
 * Copyright 2018 Ghostery, Inc. All rights reserved.
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0
 */

import React, { Component } from 'react';
import { Link } from 'react-router-dom';
import { sendMessage } from '../utils/msg';
/**
 * @class Implement footer of the detailed (expert) view which
 * acts as a menu and opens additional views.
 * @memberOf PanelClasses
 */
class DetailMenu extends React.Component {
	static mapItemsToPings(itemName) {
		switch (itemName) {
			case 'showBlocking':
				return 'list_dash';
			case 'showHistory':
				return 'history_dash';
			case 'showPerformance':
				return 'performance_dash';
			case 'showRewards':
				return 'rewards_dash';
			case 'showPremium':
				return 'premium_dash';
			default:
				return '';
		}
	}

	constructor(props) {
		super(props);

		this.state = {
			menu: {
				showBlocking: true,
				showHistory: false,
				showPerformance: false,
				showRewards: false,
				showPremium: false,
			},
		};

		// event bindings
		this.setActiveTab = this.setActiveTab.bind(this);
	}
	/**
	 * Change menu according to the clicked button. Save it in state.
	 * @param {Object} event 		click event
	 */
	setActiveTab(event) {
		const menu = Object.assign({}, this.state.menu);
		Object.keys(menu).forEach((key) => {
			if (key === event.currentTarget.id) {
				menu[key] = true;
				const pingType = DetailMenu.mapItemsToPings(key);
				if (pingType) {
					sendMessage('ping', pingType);
				}
			} else {
				menu[key] = false;
			}
		});
		this.setState({ menu });
	}
	/**
	 * Render the expert view footer.
	 * @return {ReactComponent}   ReactComponent instance
	 */
	render() {
		return (
			<div id="detail-menu">
				<div className="row small-up-5 align-bottom">
					<div className="column menu-item">
						<Link to="/detail/blocking" onClick={this.setActiveTab} id="showBlocking" className={this.state.menu.showBlocking ? 'active ' : ''}>
							<svg className="list-view-icon" viewBox="0 0 21 21" width="21" height="21">
								<g className="fill stroke" strokeWidth=".5" fillRule="evenodd">
									<path d="M19.272 17.852c0 .45-.003.902.002 1.354.001.14-.04.21-.194.209-.909-.003-1.818-.003-2.727 0-.15 0-.2-.06-.2-.205.004-.895.005-1.791 0-2.686 0-.16.061-.212.215-.211.896.005 1.791.005 2.687 0 .17-.002.222.062.22.226-.008.438-.003.876-.003 1.313m-3.844.023l.001 1.394c.001.507.341.879.85.886.957.013 1.914.013 2.87 0 .511-.007.85-.377.85-.886v-2.81c0-.508-.343-.88-.85-.885-.957-.013-1.914-.013-2.87 0-.507.006-.849.379-.85.886-.002.472 0 .943 0 1.415M16.155 3.3c0-.432.008-.863-.003-1.294-.005-.189.049-.262.249-.26.876.01 1.751.008 2.626.001.18-.002.251.047.249.24-.009.875-.007 1.75-.001 2.625.001.171-.046.241-.228.24a169.23 169.23 0 0 0-2.666 0c-.182.001-.232-.07-.228-.24.008-.438.002-.876.002-1.313m-.727.015v1.374c.002.523.336.894.856.901.957.014 1.913.015 2.87 0 .512-.009.844-.379.845-.89v-2.79c-.001-.532-.345-.897-.875-.902-.943-.009-1.886-.01-2.829 0-.521.007-.865.375-.866.893-.002.471-.001.942-.001 1.414M17.714 12.131h-1.292c-.258 0-.267-.009-.267-.256 0-.862.004-1.724-.003-2.586-.002-.188.048-.262.25-.26.874.008 1.75.007 2.625 0 .18 0 .25.047.25.24-.01.875-.01 1.75 0 2.626 0 .192-.07.243-.25.24-.437-.01-.875-.004-1.313-.004M20 10.582c0-.465.002-.93 0-1.395-.002-.522-.34-.89-.86-.896-.95-.012-1.9-.012-2.85 0-.519.006-.86.376-.86.896a864.9 864.9 0 0 0 0 2.79c0 .52.341.89.86.896.95.011 1.9.011 2.85 0 .52-.007.858-.375.86-.897v-1.394M7.579 3.663h5.946c.246 0 .396-.094.439-.273a.365.365 0 0 0-.338-.453c-.033-.002-.067-.001-.101-.001-3.977 0-7.955 0-11.933-.002-.205 0-.362.056-.432.256-.08.223.088.459.33.47.169.009.338.003.506.003h5.583zM7.56 10.219H1.632c-.06 0-.122-.004-.182.003a.359.359 0 0 0-.305.349.36.36 0 0 0 .304.371c.046.006.094.004.141.004h11.933c.041 0 .081.002.121-.002a.359.359 0 0 0 .325-.371.355.355 0 0 0-.323-.352c-.06-.006-.12-.002-.182-.002H7.56zM7.558 17.501H1.571c-.27 0-.43.142-.425.374.005.184.14.332.325.351.04.004.08.002.121.002h11.933c.255 0 .408-.103.442-.293a.36.36 0 0 0-.36-.433c-.25-.005-.5 0-.75 0H7.558z" />
								</g>
							</svg>
							<span>{ t('panel_detail_menu_list_title') }</span>
						</Link>
					</div>
					<div className="column menu-item">
						<Link to="/detail/history" onClick={this.setActiveTab} id="showHistory" className={this.state.menu.showHistory ? 'active ' : ''}>
							<svg viewBox="0 0 37 28" width="37px" height="28px">
								<g className="fill" fillRule="evenodd">
									<path d="M28.364 5.91V3.626C28.364 1.624 29.996 0 32 0c2.008 0 3.636 1.634 3.636 3.627V5.91h.37c.548 0 .994.454.994.995v5.28c0 .55-.456.997-.995.997h-8.01c-.55 0-.995-.455-.995-.996v-5.28c0-.55.456-.997.995-.997h.37zm.606.026l6.06.026V3.637c0-1.674-1.356-3.03-3.03-3.03-1.674 0-3.03 1.357-3.03 3.032v2.296z" />
									<g transform="translate(0 4)">
										<circle cx="2.21" cy="12.694" r="1.404" />
										<path d="M13.253 11.842v-6.4h-1.786v7.338h.172l5.193 4.844 1.22-1.307-4.8-4.475z" />
										<path d="M3.688 4.864C5.81 1.918 9.272 0 13.18 0c6.46 0 11.694 5.235 11.694 11.694 0 6.458-5.235 11.693-11.693 11.693-4.83 0-8.978-2.93-10.76-7.11H4.2c1.668 3.263 5.064 5.497 8.98 5.497 5.568 0 10.08-4.513 10.08-10.08 0-5.568-4.512-10.08-10.08-10.08-3.3 0-6.23 1.586-8.07 4.038l2.676 1.484-5.872 2.277-1.18-6.187 2.954 1.638z" />
									</g>
								</g>
							</svg>
							<span>{ t('panel_detail_menu_history_title') }</span>
						</Link>
					</div>
					<div className="column menu-item">
						<Link to="/detail/performance" onClick={this.setActiveTab} id="showPerformance" className={this.state.menu.showPerformance ? 'active ' : ''}>
							<svg width="39" height="26" viewBox="0 0 39 26">
								<g className="no-fill" fillRule="evenodd">
									<path className="fill" d="M30.364 5.828V3.635C30.364 1.627 31.996 0 34 0c2.008 0 3.636 1.634 3.636 3.635v2.193h.37c.548 0 .994.448.994.997v5.178c0 .55-.456.997-.995.997h-8.01c-.55 0-.995-.45-.995-.997V6.825c0-.55.456-.997.995-.997h.37zm.606.026l6.06.025V3.586c0-1.65-1.356-2.99-3.03-2.99-1.674 0-3.03 1.34-3.03 2.992v2.264z" />
									<path d="M13.92 11.723c-6.738 0-12.198 5.46-12.198 12.195 0 .262.023.517.04.774h24.315c.016-.257.04-.512.04-.774 0-6.735-5.46-12.195-12.198-12.195" />
									<path className="stroke" d="M13.92 11.723c-6.738 0-12.198 5.46-12.198 12.195 0 .262.023.517.04.774h24.315c.016-.257.04-.512.04-.774 0-6.735-5.46-12.195-12.198-12.195z" strokeWidth="1.5" />
									<path className="stroke" d="M12.244 19.434c.422.156.667-.14.942-.362 1.056-.847 2.11-1.695 3.167-2.54.662-.528 1.556-.254 1.75.544.088.35-.006.66-.232.943-.917 1.143-1.832 2.29-2.755 3.43-.125.157-.174.304-.167.505.053 1.535-1.157 2.767-2.674 2.737C10.94 24.665 9.8 23.59 9.71 22.27c-.098-1.377.87-2.605 2.212-2.808.107-.016.215-.02.322-.028zM2.292 18.516l3.07 1.147M22.246 19.663l3.07-1.147M13.92 11.723v2.95" strokeWidth="1.5" />
								</g>
							</svg>
							<span>{ t('panel_detail_menu_performance_title') }</span>
						</Link>
					</div>
					<div className="column menu-item">
						<Link to="/detail/rewards" onClick={this.setActiveTab} id="showRewards" className={this.state.menu.showRewards ? 'active ' : ''}>
							<svg width="31" height="27" viewBox="0 0 31 27">
								<g className="fill" fillRule="evenodd">
									<path d="M6.7 15.905h2.62v-3.172H6.7v3.172zm2.378-4.408l.038.1c1.064-.072 2.145-.05 3.188-.242 1.234-.226 1.7-1.528 1.036-2.585-.575-.912-2.043-1.098-2.632-.276-.502.7-.9 1.48-1.324 2.237-.133.24-.206.51-.306.767zm-2.102.078c-.16-.53-1.05-2.256-1.413-2.753-.043-.06-.088-.122-.136-.18-.837-1.04-2.424-.81-2.932.422-.38.918.16 2.087 1.054 2.282 1.122.244 2.266.158 3.426.23zm3.41 4.313h4.58v-3.16h-4.58v3.16zm-9.317.02h4.59v-3.183H1.07v3.182zm5.623 9.526H9.31V16.96H6.693v8.474zm3.7.044H14.2v-8.523h-3.807v8.523zm-8.56-.044h3.823V16.95H1.833v8.484zM.805 17.01c-.675-.178-.813-.087-.805-1.052.01-1.183.002-2.366.003-3.55 0-.555.15-.703.707-.703h1.167c.08 0 .16-.01.216-.014-.198-.346-.433-.662-.566-1.015-.483-1.285.086-2.736 1.28-3.358 1.243-.646 2.71-.282 3.52.89.616.893 1.09 1.864 1.52 2.858.04.097.09.194.16.346.1-.21.182-.372.253-.536.39-.89.802-1.767 1.362-2.567.487-.695 1.107-1.168 1.975-1.28 1.41-.182 2.77.826 3.004 2.235.137.824-.07 1.554-.548 2.223l-.153.21c.082.012.14.03.2.03.45-.004.898-.006 1.345-.013.335-.006.55.184.552.518.005 1.395.003 2.79 0 4.184 0 .283-.175.468-.464.508-.1.015-.2.017-.326.028v8.703c0 .102.002.204-.005.304-.027.346-.15.48-.493.533-.11.016-.22.016-.33.016H1.624c-.07 0-.137.002-.204-.002-.464-.027-.615-.182-.615-.65V17.01zM22.364 5.91V3.626C22.364 1.624 23.996 0 26 0c2.008 0 3.636 1.634 3.636 3.627V5.91h.37c.548 0 .994.454.994.995v5.28c0 .55-.456.997-.995.997h-8.01c-.55 0-.995-.455-.995-.996v-5.28c0-.55.456-.997.995-.997h.37zm.606.026l6.06.026V3.637c0-1.674-1.356-3.03-3.03-3.03-1.674 0-3.03 1.357-3.03 3.032v2.296z" />
								</g>
							</svg>
							<span>{ t('panel_detail_menu_rewards_title') }</span>
						</Link>
					</div>
					<div className="column menu-item">
						<Link to="/detail/premium" onClick={this.setActiveTab} id="showPremium" className={this.state.menu.showPremium ? 'active ' : ''}>
							<svg width="35" height="29" viewBox="0 0 35 29">
								<g className="fill" fillRule="evenodd">
									<path d="M26.364 5.91V3.626C26.364 1.624 27.996 0 30 0c2.008 0 3.636 1.634 3.636 3.627V5.91h.37c.548 0 .994.454.994.995v5.28c0 .55-.456.997-.995.997h-8.01c-.55 0-.995-.455-.995-.996v-5.28c0-.55.456-.997.995-.997h.37zm.606.026l6.06.026V3.637c0-1.674-1.356-3.03-3.03-3.03-1.674 0-3.03 1.357-3.03 3.032v2.296z" />
									<path className="stroke" d="M8.4 11.663H5.788l.95 3.93 1.662-3.93zm9.813.003H15.6l1.656 3.91c.015 0 .03-.004.044-.007l.913-3.904zm.345.236l-.973 4.16h4.49l-3.517-4.16zM5.445 11.9l-3.518 4.16H6.45c-.334-1.385-.663-2.75-1.005-4.16zm9.764-.165l-2.842 4.326h4.67c-.61-1.445-1.213-2.87-1.83-4.325zm-6.42 0l-1.826 4.322h4.666l-2.84-4.322zm.414-.076L12 15.913l2.794-4.255h-5.59zm12.858 4.81c-.077-.008-.108-.012-.14-.012-1.434 0-2.87.002-4.306-.004-.14 0-.182.07-.23.176-1.47 3.337-2.944 6.674-4.417 10.01-.022.05-.04.1-.06.15l.03.01c3.03-3.433 6.063-6.867 9.122-10.33zm-11 10.33l.03-.014-.068-.163c-1.47-3.33-2.942-6.66-4.408-9.993-.06-.134-.13-.177-.273-.176-1.394.006-2.79.003-4.183.003h-.232c3.07 3.475 6.1 6.91 9.133 10.343zm.733-10.326H7.013c1.59 3.63 3.168 7.237 4.746 10.844l.035-.014v-10.83zm.42-.007v10.846c.01 0 .02.003.03.005l4.79-10.85h-4.82zm-.193-5.462c2.11 0 4.22.002 6.33-.004.21 0 .353.07.488.23 1.32 1.568 2.643 3.13 3.966 4.694.262.31.26.387-.012.695L12.4 28.387c-.036.04-.07.082-.108.122-.203.22-.385.223-.584-.002-.565-.636-1.127-1.275-1.69-1.913l-8.8-9.962c-.29-.33-.29-.395-.01-.726 1.31-1.55 2.623-3.095 3.926-4.65.155-.184.317-.258.557-.257 2.112.008 4.222.005 6.332.005z" strokeWidth=".5" />
								</g>
							</svg>
							<span>{ t('panel_detail_menu_premium_title') }</span>
						</Link>
					</div>
				</div>
			</div>
		);
	}
}

export default DetailMenu;
